{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h2 class="mb-4">Visão Geral</h2>

<div class="row g-4 mb-4">
  <div class="col-md-4">
    <div class="card text-white bg-primary p-3">
      <h5>Total de Produtos</h5>
      <p class="fs-4">535</p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-success p-3">
      <h5>Movimentações Hoje</h5>
      <p class="fs-4">27</p>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-info p-3">
      <h5>Alertas de Baixo Estoque</h5>
      <p class="fs-4">8</p>
    </div>
  </div>
</div>

<div class="card p-4 mb-4">
    <h5>Estoque por Produto</h5>
    <canvas id="graficoEstoque"></canvas>
</div>

<div class="card p-4 mb-4">
    <h5 class="mb-3">Filtrar movimentações</h5>
    <form class="row g-3">
        <div class="col-md-4">
            <input type="date" class="form-control" placeholder="Data Início">
        </div>
        <div class="col-md-4">
            <input type="date" class="form-control" placeholder="Data Fim">
        </div>
        <div class="col-md-4">
            <input type="text" class="form-control" placeholder="Produto ou Categoria">
        </div>
        <div class="col-12">
            <button class="btn btn-secondary">Filtrar</button>
        </div>
    </form>
</div>

<div class="card p-4 mb-4">
    <h5 class="mb-3">Cadastrar Movimentação</h5>
    <form class="row g-3">
        <div class="col-md-4">
            <input type="text" class="form-control" placeholder="Produto">
        </div>
        <div class="col-md-2">
            <input type="number" class="form-control" placeholder="Quantidade">
        </div>
        <div class="col-md-3">
            <select class="form-select">
                <option selected disabled>Tipo</option>
                <option>Entrada</option>
                <option>Saída</option>
            </select>
        </div>
        <div class="col-md-3">
            <input type="text" class="form-control" placeholder="Responsável">
        </div>
        <div class="col-12">
            <button class="btn btn-success">Registrar</button>
        </div>
    </form>
</div>

<div class="card p-4 mb-4">
    <h5 class="mb-3">Últimas Movimentações</h5>
    <div class="table-responsive">
    <table class="table table-hover table-bordered bg-white rounded">
        <thead class="table-light">
            <tr>
                <th>Produto</th>
                <th>Tipo</th>
                <th>Quantidade</th>
                <th>Responsável</th>
                <th>Data</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Papel Higiênico</td>
                <td>Saída</td>
                <td>20</td>
                <td>João</td>
                <td>2025-06-16</td>
            </tr>
            <tr>
                <td>Álcool Gel</td>
                <td>Entrada</td>
                <td>50</td>
                <td>Ana</td>
                <td>2025-06-16</td>
            </tr>
            <tr>
                <td>Sabonete</td>
                <td>Saída</td>
                <td>10</td>
                <td>Lucas</td>
                <td>2025-06-15</td>
            </tr>
        </tbody>
    </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
fetch('/dados')
  .then(res => res.json())
  .then(data => {
    const ctx = document.getElementById('graficoEstoque');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: data.map(p => p.nome),
        datasets: [{
          label: 'Quantidade',
          data: data.map(p => p.quantidade),
          backgroundColor: 'rgba(94, 114, 228, 0.8)'
        }]
      }
    });
  });
</script>
{% endblock %}
